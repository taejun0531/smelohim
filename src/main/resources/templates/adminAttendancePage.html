<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>임원용 출석부</title>

    <link rel="stylesheet" type="text/css" href="/css/adminAttendancePage.css">
    <script type="text/javascript" src="/js/themeToggle.js" defer></script>
    <script type="text/javascript" src="/js/adminAttendancePage.js" defer></script>
</head>
<body>
<!-- Topbar -->
<div class="topbar">
    <div class="brand">엘로힘 청년부</div>
    <a href="/" class="moveMainPageText">메인 페이지</a>
    <button id="toggleTheme" class="theme-toggle" aria-pressed="false">🌙 다크모드</button>
</div>

<!-- Page header : 항상 '임원용 출석부' -->
<div class="page-header">
    <h1>임원용 출석부</h1>
</div>

<!-- 셀 선택 카드 -->
<div class="cell-selector-card">
    <div class="cell-selector-header">
        <div class="cell-selector-title-row">
            <span class="cell-selector-title-dot"></span>
            <span class="cell-selector-title">셀 선택</span>
        </div>
    </div>

    <div class="cell-selector-grid">
        <!-- cellList: { cellKey(리더 member.id), cellName } 목록 -->
        <button type="button"
                class="cell-card"
                th:each="cell : ${cellList}"
                th:data-cell-key="${cell.cellKey}"
                th:data-cell-name="${cell.cellName}"
                th:text="${cell.cellName}">
            태준셀
        </button>

        <div class="cell-empty-message"
             th:if="${#lists.isEmpty(cellList)}">
            등록된 셀이 없습니다. 셀 정보를 먼저 등록해주세요.
        </div>
    </div>
</div>

<!-- 달 선택 카드 -->
<div class="month-card">
    <div class="month-nav">
        <button id="prevMonth" class="month-btn" type="button" aria-label="이전 달로 이동">◀</button>

        <div class="month-label">
            <span id="yearLabel">0000</span>년
            <span id="monthLabel">00</span>월
        </div>

        <!-- 달 선택 드롭다운 -->
        <div class="date-dropdown-wrapper">
            <button id="dateDropdownToggle"
                    class="date-dropdown-toggle"
                    type="button"
                    aria-haspopup="listbox"
                    aria-expanded="false">
                <span class="date-dropdown-text">달 선택</span>
                <span class="date-dropdown-caret">▼</span>
            </button>
            <div id="dateDropdownPanel" class="date-dropdown hidden" role="listbox">
                <!-- JS에서 작년~올해 월 리스트 삽입 -->
            </div>
        </div>

        <button id="nextMonth" class="month-btn" type="button" aria-label="다음 달로 이동">▶</button>
    </div>

    <div class="month-note">
        선택된 <strong>달</strong> 기준으로 각 주일 출석을 조회/수정합니다.
    </div>
</div>

<!-- 좌/우 2컬럼 레이아웃: 왼쪽 출석, 오른쪽 개별 통계 -->
<div class="attendance-layout">
    <!-- 왼쪽: 출석 현황 -->
    <div class="card card-attendance">
        <div class="card-header-row">
            <div class="table-title">
                <span class="dot"></span>
                <span id="attendanceTitleText">출석 현황</span>
            </div>
            <button id="saveAttendanceBtn" type="button" class="btn primary">
                출석 저장
            </button>
        </div>

        <div class="table-wrapper">
            <table id="attendanceTable">
                <thead>
                <tr id="headerRow1">
                    <th rowspan="2" class="col-name">이름</th>
                    <!-- JS에서 선택된 달의 주일 헤더 + 요약 박스 추가 (colspan=3) -->
                </tr>
                <tr id="headerRow2">
                    <!-- JS에서 각 주일별 '예배' / '셀' / '메모' 헤더 삽입 -->
                </tr>
                </thead>
                <tbody id="attendanceBody">
                <!-- 셀 선택 전에는 비어 있고, 셀 선택 후 JS로 채움 -->
                </tbody>
            </table>
        </div>

        <div class="card-footer">
            <p class="help-text">
                출석 체크 / 메모 입력 후 <strong>‘출석 저장’</strong> 버튼을 눌러야 데이터가 저장됩니다.
            </p>
        </div>
    </div>

    <!-- 오른쪽: 개별 통계 -->
    <div class="card card-stats">
        <div class="card-header-row">
            <div class="table-title">
                <span class="dot"></span>
                <span>개별 통계</span>
            </div>
        </div>

        <!-- 기간 선택 -->
        <div class="stats-filter-row">
            <div class="stats-filter-field">
                <label for="statsStartDate" class="stats-label">시작일</label>
                <input type="date" id="statsStartDate" class="stats-input">
            </div>
            <div class="stats-filter-field">
                <label for="statsEndDate" class="stats-label">종료일</label>
                <input type="date" id="statsEndDate" class="stats-input">
            </div>
            <button id="loadStatsBtn" type="button" class="btn stats-btn">
                통계 조회
            </button>
        </div>

        <p class="stats-help">
            현재 선택된 셀의 각 셀원별 <strong>결석 / 예배 / 셀모임</strong> 횟수를 집계합니다.
        </p>

        <div class="table-wrapper stats-table-wrapper">
            <table id="statsTable">
                <thead>
                <tr>
                    <th class="col-name">이름</th>
                    <th>결석</th>
                    <th>예배</th>
                    <th>셀모임</th>
                </tr>
                </thead>
                <tbody id="statsBody">
                <!-- JS에서 통계 데이터 렌더링 (초기에는 비어 있음) -->
                </tbody>
            </table>
        </div>
    </div>
</div>

</body>
</html>
