<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>출석부</title>
    <link rel="stylesheet" type="text/css" href="/css/userAttendancePage.css">
    <script type="text/javascript" src="/js/themeToggle.js" defer></script>
    <script type="text/javascript" src="/js/userAttendancePage.js" defer></script>
</head>
<body>
<!-- Topbar -->
<div class="topbar">
    <div class="brand">엘로힘 청년부</div>
    <a href="/" class="moveMainPageText">메인 페이지</a>
    <button id="toggleTheme" class="theme-toggle" aria-pressed="false">🌙 다크모드</button>
</div>

<!-- Page header -->
<div class="page-header">
    <h1 th:text="${cellName + ' 출석부'}"></h1>
</div>

<!-- Week navigator -->
<div class="month-card">
    <div class="month-nav">
        <!-- id는 그대로 사용 (prevMonth / nextMonth) -->
        <button id="prevMonth" class="month-btn" type="button" aria-label="이전 주로 이동">◀</button>

        <div class="month-label">
            <span id="yearLabel">0000</span>년
            <span id="monthLabel">00</span>월
            <span id="dayLabel">00</span>일(주일)
        </div>

        <!-- 날짜 선택 드롭다운 -->
        <div class="date-dropdown-wrapper">
            <button id="dateDropdownToggle"
                    class="date-dropdown-toggle"
                    type="button"
                    aria-haspopup="listbox"
                    aria-expanded="false">
                <span class="date-dropdown-text">날짜 선택</span>
                <span class="date-dropdown-caret">▼</span>
            </button>
            <div id="dateDropdownPanel" class="date-dropdown hidden" role="listbox">
                <!-- JS에서 작년, 올해 주일 리스트 삽입 -->
            </div>
        </div>

        <button id="nextMonth" class="month-btn" type="button" aria-label="다음 주로 이동">▶</button>
    </div>

    <div class="month-note">
        선택된 <strong>날짜</strong>를 확인 후 <strong>출석 체크</strong>해주세요.
    </div>
</div>

<!-- Attendance table -->
<div class="card">
    <div class="card-header-row">
        <div class="table-title">
            <span class="dot"></span>
            <span>출석 현황</span>
        </div>
        <button id="saveAttendanceBtn" type="button" class="btn primary">
            출석 저장
        </button>
    </div>

    <!-- ✅ 요약 박스 3개 (셀모임 / 예배 / 결석) -->
    <div class="summary-row">
        <div class="summary-chip summary-absent">
            <span class="summary-label">결석</span>
            <span id="absentCount" class="summary-value">0</span>
        </div>
        <div class="summary-chip summary-worship">
            <span class="summary-label">예배</span>
            <span id="worshipCount" class="summary-value">0</span>
        </div>
        <div class="summary-chip summary-cell">
            <span class="summary-label">셀모임</span>
            <span id="cellCount" class="summary-value">0</span>
        </div>
    </div>

    <div class="table-wrapper">
        <table id="attendanceTable">
            <thead>
            <tr id="headerRow1">
                <th rowspan="2" class="col-name">이름</th>
                <!-- JS에서 해당 주의 주일 날짜(한 칸, colspan=3) 삽입 -->
            </tr>
            <tr id="headerRow2">
                <!-- JS에서 '예배' / '셀' / '메모' 헤더 삽입 -->
            </tr>
            </thead>
            <tbody id="attendanceBody">
            <!-- 멤버 행 -->
            <tr th:each="member : ${memberList}"
                th:data-member-id="${member.id}"
                th:data-member-name="${member.memberName}">
                <td class="member-name" th:text="${member.memberName}"></td>
                <!-- JS에서 해당 주의 주일에 대한 예배/셀/메모 셀 추가 -->
            </tr>
            </tbody>
        </table>
    </div>

    <div class="card-footer">
        <p class="help-text">
            출석 체크 / 메모 입력 후 <strong>‘출석 저장’</strong> 버튼을 눌러야 데이터가 저장됩니다.
        </p>
    </div>
</div>

</body>
</html>
